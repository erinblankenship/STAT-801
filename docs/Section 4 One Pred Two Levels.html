<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Section 4: One Predictor Variable, Two Levels – Stat 801A Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Section 5 One Pred More Than Two Levels.html" rel="next">
<link href="./Section 3 Sampling Distributions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ffd282cb318059e0bcb130885a47f5dc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Section 4 One Pred Two Levels.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One Predictor/Explanatory Variable, Two Levels</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Stat 801A Notes</a> 
        <div class="sidebar-tools-main">
    <a href="./Stat-801A-Notes.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals for STAT 801A</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 1 Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data and the Scientific Method</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 2 Probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability Basics and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 3 Sampling Distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sampling Distributions and Foundations of Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 4 One Pred Two Levels.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One Predictor/Explanatory Variable, Two Levels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 5 One Pred More Than Two Levels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">One Predictor/Explanatory Variable, More Than Two Levels</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#categorical-response-two-levels" id="toc-categorical-response-two-levels" class="nav-link active" data-scroll-target="#categorical-response-two-levels"><span class="header-section-number">4.1</span> Categorical Response, Two Levels</a></li>
  <li><a href="#quantitative-response" id="toc-quantitative-response" class="nav-link" data-scroll-target="#quantitative-response"><span class="header-section-number">4.2</span> Quantitative Response</a></li>
  <li><a href="#comparing-paired-means" id="toc-comparing-paired-means" class="nav-link" data-scroll-target="#comparing-paired-means"><span class="header-section-number">4.3</span> Comparing Paired Means</a></li>
  <li><a href="#comparing-variances" id="toc-comparing-variances" class="nav-link" data-scroll-target="#comparing-variances"><span class="header-section-number">4.4</span> Comparing Variances</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One Predictor/Explanatory Variable, Two Levels</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>As mentioned at the end of Chapter 3, we’ll now move on to cases in which we have a single explanatory variable and a single response variable. In this section, we’ll cover the case where the explanatory variable is categorical with only two levels, and the response variable is either categorical or numeric. This means that in this chapter, we’ll be focusing on comparing two groups.</p>
<p>Data like these may show up in a spreadsheet like</p>
<p><br>
<br>
<br>
<br>
</p>
<section id="categorical-response-two-levels" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="categorical-response-two-levels"><span class="header-section-number">4.1</span> Categorical Response, Two Levels</h2>
<p>First, we’ll consider situations in which two categorical variables are measured on each unit in the sample, and each variable has two possible values. In cases like these, typically one variable is considered the response and one variable is considered explanatory. The explanatory variable may be randomly assigned (like whether a subject was assigned to a treatment or control) or it may be merely observed (like smoking status).</p>
<p><br>
<br>
<br>
</p>
<p>The two possible values of the explanatory variable lead to two groups, and we’re interested in comparing the population proportions that arise from these two groups. We’ll focus on the function of parameters <span class="math inline">\(p_1 - p_2\)</span>. The natural estimate of this is <span class="math inline">\(\hat{p_1} - \hat{p_2}\)</span>: the difference in the sample proportions. We’ll be constructing hypothesis tests to compare <span class="math inline">\(p_1\)</span> to <span class="math inline">\(p_2\)</span> and finding confidence intervals to estimate <span class="math inline">\(p_1 - p_2\)</span>. To demonstrate these methods, we’ll use an example.</p>
<p><strong>Example:</strong> Biologists studying crows will capture a crow, tag it, and release it. These crows seem to remember the scientists who caught them and will scold them later. A study to examine this effect had several scientists wear a caveman mask while they trapped and tagged 7 crows. A control group did not tag any crows and wore a different mask. The two masks did not elicit different reactions from the crows before tagging. Volunteers then strolled around town wearing one or the other of the two masks.The crows scolded a person wearing a caveman mask in 158 out of 444 encounters with crows, whereas crows scolded a person in a neutral mask in 109 out of 922 encounters. Suppose we want to find a confidence interval for the difference in proportion of crow scoldings between volunteers wearing the caveman mask and those wearing the neutral mask.</p>
<p>For a single proportion, we needed two conditions to be met to ensure the sampling distribution of <span class="math inline">\(\hat{p}\)</span> is approximately normal:</p>
<ul>
<li><br>
</li>
<li><br>
<br>
<br>
</li>
</ul>
<p>If these conditions are met, then</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>We must meet similar conditions to ensure the sampling distribution of <span class="math inline">\(\hat p_1 - \hat p_2\)</span> is approximately normal:</p>
<ul>
<li><p><br>
<br>
</p></li>
<li><p><br>
<br>
<br>
</p></li>
</ul>
<p>If these conditions are met, then</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Like before we don’t know <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>, so we’ll use our best guess. And, like before, our best guess will change depending on whether we’re constructing a confidence interval or carrying out a hypothesis test.</p>
<div style="page-break-after: always;"></div>
<p>How is this going to play out in a confidence interval?</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Let’s go back to the crows.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
<p>How is this going to play out in a hypothesis test?</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Again, let’s go back to the crows.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
<p>We can also do this is R or SAS, but either program will use a different (but also not really) approach. We’ll start with R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">158</span>,<span class="dv">109</span>), <span class="at">n=</span><span class="fu">c</span>(<span class="dv">444</span>,<span class="dv">922</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  c(158, 109) out of c(444, 922)
X-squared = 106.11, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: two.sided
95 percent confidence interval:
 0.1867976 0.2884716
sample estimates:
   prop 1    prop 2 
0.3558559 0.1182213 </code></pre>
</div>
</div>
<p>From this output, what looks familiar?</p>
<p><br>
</p>
<p>What doesn’t look familiar?</p>
<p><br>
<br>
</p>
<p>But is this what we actually tested?</p>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">158</span>,<span class="dv">109</span>), <span class="at">n=</span><span class="fu">c</span>(<span class="dv">444</span>,<span class="dv">922</span>),<span class="at">alternative=</span><span class="st">"greater"</span>,<span class="at">correct=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions without continuity correction

data:  c(158, 109) out of c(444, 922)
X-squared = 107.62, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: greater
95 percent confidence interval:
 0.196371 1.000000
sample estimates:
   prop 1    prop 2 
0.3558559 0.1182213 </code></pre>
</div>
</div>
<p>What do you notice?</p>
<div style="page-break-after: always;"></div>
<p>In SAS, we can use <code>proc freq</code>. First, we’ll need to read in the data.</p>
<pre><code>data crows;
  input mask $ NumScold Total;
  response="Scold"; Count=NumScold;  output;
  response="NoScold"; Count=Total-NumScold; output;
  datalines;
Caveman 158 444
Neutral 109 922
;

proc print data=crows; run;</code></pre>
<p>Here’s the data set</p>
<pre><code>                                         Num
                      Obs     mask      Scold    Total    response    Count

                       1     Caveman     158      444      Scold       158
                       2     Caveman     158      444      NoSco       286
                       3     Neutral     109      922      Scold       109
                       4     Neutral     109      922      NoSco       813</code></pre>
<p>Now, to get the test</p>
<pre><code>proc freq data=crows;
  weight Count;
  table mask*response/chisq;
run;</code></pre>
<p>which gives</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proc freq.jpg" class="img-fluid figure-img" alt="The image shows the output from SAS proc freq, the procedure used to compare two proportions" width="774"></p>
<figcaption>Output from proc freq</figcaption>
</figure>
</div>
<p>Why do both R and SAS carry out the procedure like this? This is a method that can be used in situations where both the explanatory and response variable have any number (<span class="math inline">\(\geq 2\)</span>) possible values. We’ll see examples like this in the next chapter.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>But! The methods are actually doing the same thing. Let’s look at the test we carried out by hand.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
<p><strong>Example:</strong> Do metal tags on penguins harm them? Scientists trying to tell penguins apart have several ways to tag the birds. One method involves wrapping metal strips with ID numbers around the penguin’s flipper, while another involves electronic tags. Neither tag seems to physically harm the penguins. However, since tagged penguins are used to study <strong>all</strong> penguins, scientists wanted to determine whether the tagging method has any effect. Data were collected over a 10-year time span from a sample of 100 penguins that were randomly given either metal or electronic tags. Information collected includes number of chicks, survival over the decade, and length of time on foraging trips. Let’s first consider survival. We’re interested in estimating the difference in survival rate between penguins with metal tags and penguins with electronic tags.</p>
<p>What parameters are of interest here?</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p>What kind of research question are we trying to answer? What does this imply about the analysis method?</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>What next?</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Let’s do the analysis in R.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
</p>
</section>
<section id="quantitative-response" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="quantitative-response"><span class="header-section-number">4.2</span> Quantitative Response</h2>
<p><strong>Example:</strong> Data were collected over a 10-year time span from a sample of 100 penguins that were randomly given either metal or electronic tags. Information collected includes number of chicks, survival over the decade, and length of time on foraging trips. Now let’s focus on length of foraging trips. Longer foraging trips can jeopardize both breeding success and survival of chicks waiting for food. Suppose we’re interested in estimating the difference in mean trip length between penguins with metal tags and those with electronic tags.</p>
<p>What are the parameters?</p>
<p><br>
<br>
<br>
</p>
<p>What kind of research question are we trying to answer? What does this imply about the analysis method?</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p>What’s different from the crows example?</p>
<p><br>
<br>
<br>
<br>
</p>
<p>This means we will have to change our analysis approach.</p>
<p>Just like with the <span class="math inline">\(t\)</span> methods for single means, we need to check conditions to determine whether we can the <span class="math inline">\(t\)</span>-distribution to construct tests and form confidence intervals for the difference in means.</p>
<ul>
<li>Independence–both between and within groups</li>
<li>Check normality of each group separately (basically checking for extreme outliers)</li>
<li>If these are both met, then the standard error of <span class="math inline">\(\bar x_1 - \bar x_2\)</span> is <span class="math inline">\(SE = \sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma^2_2}{n_2}}\)</span> with <span class="math inline">\(df=\)</span> really complicated (you’ll see we get non-integers in R/SAS–it’s doing the complicated calculation). We’ll use <span class="math inline">\(\min(n_1-1, n_2-1)\)</span> if we’re not using R/SAS. We won’t know <span class="math inline">\(\sigma^2_1\)</span> and <span class="math inline">\(\sigma_2^2\)</span>, so we’ll approximate the standard error using <span class="math inline">\(SE \approx \sqrt{\frac{s_1^2}{n_1} + \frac{s^2_2}{n_2}}\)</span></li>
</ul>
<p><br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
<p>As with tests for a single mean (and one proportion, and two proportions), our test statistic will have the usual form: <span class="math display">\[
\hbox{test statistic} = \frac{\hbox{observed value - hypothesized value}}{SE}
\]</span> In the case of two means, this is <span class="math display">\[
T = \frac{(\bar x_1 - \bar x_2) - 0}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}
\]</span> When the null hypothesis is true and the conditions are met, <span class="math inline">\(T\)</span> has a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(df=\min(n_1-1,n_2-1)\)</span>.</p>
<p>Confidence intervals will also have the same form: <span class="math display">\[
\hbox{observed statistic} \pm \hbox{multiplier} \times SE
\]</span> For this specific situation of comparing two independent means, this is <span class="math display">\[
(\bar x_1 - \bar x_2) \pm t^*_{df} \times \sqrt{\frac{s_1^2}{n_1} + \frac{s^2_2}{n_2}}
\]</span> and we’ll again use <span class="math inline">\(df=\min(n_1-1,n_2-1)\)</span> (or let R/SAS calculate it for us).</p>
<p>With two proportions, our SE changed depending on whether we were doing a hypothesis test or calculating a confidence interval. Here, it doesn’t. Any guesses why?</p>
<p><br>
<br>
<br>
</p>
<p><strong>Example:</strong> There were 344 foraging trips made by penguins with a metal tag, and those trips had a sample mean of <span class="math inline">\(\bar x_{M} =12.70\)</span> days with standard deviation <span class="math inline">\(s_{M}=3.71\)</span> days. For those penguins with electronic tags, the mean was <span class="math inline">\(\bar x_{E} = 11.60\)</span> days with standard deviation <span class="math inline">\(s_{E}=4.53\)</span> days over 512 trips.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
<p><strong>Example:</strong> Another variable measured was the date penguins arrive at the breeding site, with later arrivals hurting breeding success. Arrival date is measured as the number of days after 1 November. The researchers are interested in whether metal tagged penguins arrive later than electronic tagged penguins.</p>
<p>What are the parameters?</p>
<p><br>
<br>
<br>
</p>
<p>What kind of research question are we trying to answer? What does this imply about the analysis method?</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Mean arrival date for the 167 times metal tagged penguins arrived was 7 December (37 days after 1 November) with standard deviation <span class="math inline">\(s_{M}=38.77\)</span> days, while mean arrival date for the 189 times electronic tagged penguins arrived was 21 November (21 days after 1 November) with standard deviation <span class="math inline">\(s_{E}=27.50\)</span></p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
<p>We can easily carry out <span class="math inline">\(t\)</span> tests and confidence intervals in R and SAS. But, we can’t for the penguin data. R and SAS both require the whole data set, as opposed to summary statistics.</p>
<p><strong>Example:</strong> The data set may be found in Canvas: ‘NutritionStudy.csv’. This data set gives nutrition levels in people’s blood as well as information about their eating habits, and comes from a random sample of 315 US adults. Suppose we are interested in estimating the difference in mean beta carotene blood level between smokers and non-smokers. Let’s start by reading the data into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>NutritionStudy<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"NutritionStudy.csv"</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(NutritionStudy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID Age Smoke Quetelet Vitamin Calories  Fat Fiber Alcohol Cholesterol
1  1  64    No  21.4838       1   1298.8 57.0   6.3     0.0       170.3
2  2  76    No  23.8763       1   1032.5 50.1  15.8     0.0        75.8
3  3  38    No  20.0108       2   2372.3 83.6  19.1    14.1       257.9
4  4  40    No  25.1406       3   2449.5 97.5  26.5     0.5       332.6
5  5  72    No  20.9850       1   1952.1 82.6  16.2     0.0       170.8
6  6  40    No  27.5214       3   1366.9 56.0   9.6     1.3       154.6
  BetaDiet RetinolDiet BetaPlasma RetinolPlasma    Sex VitaminUse PriorSmoke
1     1945         890        200           915 Female    Regular          2
2     2653         451        124           727 Female    Regular          1
3     6321         660        328           721 Female Occasional          2
4     1061         864        153           615 Female         No          2
5     2863        1209         92           799 Female    Regular          1
6     1729        1439        148           654 Female         No          2</code></pre>
</div>
</div>
<p>If I wanted to calculate the confidence interval by hand, I could use R to get the summary statistics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>NutMeanNS<span class="ot">&lt;-</span><span class="fu">mean</span>(NutritionStudy<span class="sc">$</span>BetaPlasma[NutritionStudy<span class="sc">$</span>Smoke<span class="sc">==</span><span class="st">"No"</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>NutMeanNS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200.7316</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>NutSDNS<span class="ot">&lt;-</span><span class="fu">sd</span>(NutritionStudy<span class="sc">$</span>BetaPlasma[NutritionStudy<span class="sc">$</span>Smoke<span class="sc">==</span><span class="st">"No"</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>NutSDNS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 192.2929</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>size_NS<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">with</span>(<span class="at">data=</span>NutritionStudy, Smoke<span class="sc">==</span><span class="st">"No"</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>size_NS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 272</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>NutMeanS<span class="ot">&lt;-</span><span class="fu">mean</span>(NutritionStudy<span class="sc">$</span>BetaPlasma[NutritionStudy<span class="sc">$</span>Smoke<span class="sc">==</span><span class="st">"Yes"</span>])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>NutMeanS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 121.3256</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>NutSDS<span class="ot">&lt;-</span><span class="fu">sd</span>(NutritionStudy<span class="sc">$</span>BetaPlasma[NutritionStudy<span class="sc">$</span>Smoke<span class="sc">==</span><span class="st">"Yes"</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>NutSDS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 78.81163</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>size_S<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">with</span>(<span class="at">data=</span>NutritionStudy, Smoke<span class="sc">==</span><span class="st">"Yes"</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>size_S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43</code></pre>
</div>
</div>
<p>So now we have all the components we need to calculate the confidence interval.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
<p>We can also let R calculate the confidence interval for us, using <code>t.test</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(BetaPlasma<span class="sc">~</span>Smoke,<span class="at">data=</span>NutritionStudy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  BetaPlasma by Smoke
t = 4.7421, df = 139.15, p-value = 5.175e-06
alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
95 percent confidence interval:
  46.29873 112.51335
sample estimates:
 mean in group No mean in group Yes 
         200.7316          121.3256 </code></pre>
</div>
</div>
<p>We can change the confidence level easily</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(BetaPlasma<span class="sc">~</span>Smoke,<span class="at">data=</span>NutritionStudy, <span class="at">conf.level=</span><span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  BetaPlasma by Smoke
t = 4.7421, df = 139.15, p-value = 5.175e-06
alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
90 percent confidence interval:
  51.67854 107.13353
sample estimates:
 mean in group No mean in group Yes 
         200.7316          121.3256 </code></pre>
</div>
</div>
<p>Let’s carry out a test by hand, to see how it compares to the output.</p>
<p><br>
<br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
</section>
<section id="comparing-paired-means" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="comparing-paired-means"><span class="header-section-number">4.3</span> Comparing Paired Means</h2>
<p>Everything we’ve done so far has assumed independence among observations. If we only had one group, it was just independence among observations. If we had two or more groups, it was independence between and within groups. Now, we’ll turn our attention to a common situation: dependence between groups. Specifically, a particular dependency–pairing. This occurs in before/after studies, other studies in which subjects are matched. For example, considering the price of a item purchased from two different retailers.</p>
<p>In these situations, we generally take the difference between the two values, and consider the difference as our observation. So, for example, if we want to compare cost of textbooks between the campus bookstore and Amazon, we’d randomly select a set of book titles, and find their price at both the bookstore and Amazon. We’d find the difference in price, and use those differences as our observations.</p>
<p>Note that we’re distinguishing between and .</p>
<p>Good news: we’ve already seen how to construct tests and confidence intervals here! We just use the same techniques we used for a single mean (Chapter 3), but on the differences. The changes come in the form of the hypotheses and interpretation of the confidence interval.</p>
<p><strong>Example:</strong> Long distance runners contend that moderate exposure to ozone increases lung capacity. In investigate this possibility, a researcher exposed 12 rats to ozone at the rate of 2 ppm for a period of 30 days. The lung capacity of the rats was determined at the beginning of the study and again after 30 days of ozone exposure. The lung capacities (in mL) are in the file ‘ozone.csv’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ozone<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"ozone.csv"</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ozone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Rat Before After
1   1    8.7   9.4
2   2    7.9   9.8
3   3    8.3   9.9
4   4    8.4  10.3
5   5    9.2   8.9
6   6    9.1   8.8</code></pre>
</div>
</div>
<p>The first thing we’ll do is calculate the change in lung capacity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ozone<span class="sc">$</span>diff<span class="ot">&lt;-</span>ozone<span class="sc">$</span>Before <span class="sc">-</span> ozone<span class="sc">$</span>After</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ozone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Rat Before After diff
1   1    8.7   9.4 -0.7
2   2    7.9   9.8 -1.9
3   3    8.3   9.9 -1.6
4   4    8.4  10.3 -1.9
5   5    9.2   8.9  0.3
6   6    9.1   8.8  0.3</code></pre>
</div>
</div>
<p>What is the parameter?</p>
<p><br>
<br>
<br>
</p>
<p>What research question are we trying to answer?</p>
<p><br>
<br>
<br>
</p>
<p>What does this imply about the analysis method we should use?</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(ozone<span class="sc">$</span>diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  ozone$diff
t = -3.885, df = 11, p-value = 0.002541
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -1.8928932 -0.5237735
sample estimates:
mean of x 
-1.208333 </code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(ozone<span class="sc">$</span>Before,ozone<span class="sc">$</span>After,<span class="at">paired=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  ozone$Before and ozone$After
t = -3.885, df = 11, p-value = 0.002541
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -1.8928932 -0.5237735
sample estimates:
mean difference 
      -1.208333 </code></pre>
</div>
</div>
<p>What is incorrect about this analysis in R? How can we fix it?</p>
<p><br>
<br>
<br>
<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(ozone<span class="sc">$</span>Before,ozone<span class="sc">$</span>After,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">alternative=</span><span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  ozone$Before and ozone$After
t = -3.885, df = 11, p-value = 0.001271
alternative hypothesis: true mean difference is less than 0
95 percent confidence interval:
       -Inf -0.6497695
sample estimates:
mean difference 
      -1.208333 </code></pre>
</div>
</div>
<p>Let’s write a couple of conclusions here.</p>
<div style="page-break-after: always;"></div>
<p>What are the consequences of ignoring pairing? Let’s look at a different example.</p>
<p><strong>Example:</strong> Suppose you are playing baseball and hit a hard line drive. You want to turn a single into a double. Does the path you take to round first base make a difference? A masters thesis way back in 1970 considered the difference between a “narrow angle” and a “wide angle” around first base. Suppose we have 22 baseball players who have volunteered to participate. There are a couple ways we could design an experiment to see if there is a difference.</p>
<ul>
<li>Randomly assign 11 players to run a wide angle and 11 players to run a narrow angle. Problems: some players may be faster than others. Ideally, randomization will equally distribute the speedy runners between the two groups, but there is no guarantee. Speed could be a confounding variable.</li>
<li>Have each of the 22 runners run both angles, with the angle run first randomized using a coin. This allows each player to serve as their own control.</li>
</ul>
<p>The second option is what the thesis writer did–he randomly determined the angle the player would take first. He then used a stopwatch the time the run from going from a spot 35 feet past home to a spot 15 feet before 2nd base. After a rest period, the runner then ran the second angle. This controls for runner-to-runner variability. It’s important to randomize the order of the treatments, where possible! (This isn’t possible in before-and-after type studies.)</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Section-4-One-Pred-Two-Levels_files/figure-html/bases-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Section-4-One-Pred-Two-Levels_files/figure-html/diff-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.075</code></pre>
</div>
</div>
<p>Parameter of interest:</p>
<p>Hypotheses of interest:</p>
<p><br>
<br>
<br>
<br>
</p>
<p>Observed statistic:</p>
<p>Like before, we’re trying to determine if it’s surprising to see such a large difference as <span class="math inline">\(\bar x_d = 0.075\)</span> just by chance, if running strategy has no effect on running time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(bases<span class="sc">$</span>diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  bases$diff
t = 3.9837, df = 21, p-value = 0.0006754
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.03584814 0.11415186
sample estimates:
mean of x 
    0.075 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(time<span class="sc">~</span>angle,<span class="at">data=</span>bases2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  time by angle
t = 0.93383, df = 41.899, p-value = 0.3557
alternative hypothesis: true difference in means between group narrow and group wide is not equal to 0
95 percent confidence interval:
 -0.08709334  0.23709334
sample estimates:
mean in group narrow   mean in group wide 
            5.534091             5.459091 </code></pre>
</div>
</div>
</section>
<section id="comparing-variances" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="comparing-variances"><span class="header-section-number">4.4</span> Comparing Variances</h2>
<p>Often it is useful to test if variances from independent populations are different. For example,</p>
<ul>
<li><p>a geneticist wants to test equality of the genotypic variances of kernel weight of two different corn populations</p></li>
<li><p>an engineer is interested in comparing the process variance of two different types of production systems used to make a electronic component</p></li>
<li><p>the two-sample <span class="math inline">\(t\)</span>-test is based on the assumption that the variances of the two populations are equal</p></li>
</ul>
<p>Assume the data from both populations follow a normal distribution with different means and possibly different variances. We want to test</p>
<p><br>
<br>
<br>
<br>
</p>
<p>A natural approach would be to take samples of <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> observations from the two populations, and compute <span class="math inline">\(s_1^2\)</span> and <span class="math inline">\(s_2^2\)</span>. We could then take the ratio <span class="math inline">\(s_1^2/s_2^2\)</span> and reject H<span class="math inline">\(_0\)</span> if the ratio is very different from 1. But, we need to know the sampling distribution of the ratio <span class="math inline">\(S^2_1/S^2_2\)</span>. Recall</p>
<p><br>
<br>
<br>
<br>
</p>
<div style="page-break-after: always;"></div>
<p>Sir R. A. Fisher showed that the ratio of two independent <span class="math inline">\(\chi^2\)</span> distributions has an <span class="math inline">\(F\)</span> distribution with <span class="math inline">\((n_1-1)\)</span> and <span class="math inline">\((n_2-1)\)</span> degrees of freedom. Specifically,</p>
<p><br>
<br>
<br>
<br>
</p>
<p>Under H<span class="math inline">\(_0: \sigma^2_1 = \sigma^2_2\)</span> then</p>
<p><br>
<br>
</p>
<p>The <span class="math inline">\(F\)</span> distribution</p>
<ul>
<li>is non-negative, unimodal, and right skewed</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Section-4-One-Pred-Two-Levels_files/figure-html/F-distribution-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>the shape of the distribution depends on the numerator and denominator degrees of freedom</li>
</ul>
<p>So, to test H<span class="math inline">\(_0: \sigma_1^2 = \sigma_2^2\)</span> versus H<span class="math inline">\(_a: \sigma_1^2 \neq \sigma_2^2\)</span>, we can</p>
<ul>
<li><p>Assume that <span class="math inline">\(S_1^2\)</span> is the larger of the two sample variaces</p></li>
<li><p>Use <span class="math inline">\(S_1^2/S_2^2\)</span> as a test statistic. Under H<span class="math inline">\(_0\)</span>, this ratio will follow an <span class="math inline">\(F\)</span> distribution with <span class="math inline">\(n_1-1\)</span> and <span class="math inline">\(n_2-1\)</span> degrees of freedom</p></li>
<li><p>Use the <span class="math inline">\(F\)</span> distribution to see if <span class="math inline">\(s_1^2/s_2^2\)</span> is enough bigger than 1 to convince us the null hypothesis is not true (always a right-tail test!)</p></li>
</ul>
<p><strong>Example:</strong> The writings of different authors can be partially characterized by the variablity in the lengths of their sentences. Two manuscripts, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, are found by a historian and they want to know whether they have the same author. Fifteen sentences from each are chosen at random, and word counts per sentence are recorded. The historian finds <span class="math inline">\(s_A^2= 0.114\)</span> and <span class="math inline">\(s_B^2= 0.143\)</span>.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>We can use <code>var.test()</code> in R, but must have the whole data set.</p>
<p><strong>Example:</strong> Earlier, we used a data set with nutrition levels in people’s blood as well as information about their eating habits that came from a random sample of 315 US adults.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>NutritionStudy<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"NutritionStudy.csv"</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(NutritionStudy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID Age Smoke Quetelet Vitamin Calories  Fat Fiber Alcohol Cholesterol
1  1  64    No  21.4838       1   1298.8 57.0   6.3     0.0       170.3
2  2  76    No  23.8763       1   1032.5 50.1  15.8     0.0        75.8
3  3  38    No  20.0108       2   2372.3 83.6  19.1    14.1       257.9
4  4  40    No  25.1406       3   2449.5 97.5  26.5     0.5       332.6
5  5  72    No  20.9850       1   1952.1 82.6  16.2     0.0       170.8
6  6  40    No  27.5214       3   1366.9 56.0   9.6     1.3       154.6
  BetaDiet RetinolDiet BetaPlasma RetinolPlasma    Sex VitaminUse PriorSmoke
1     1945         890        200           915 Female    Regular          2
2     2653         451        124           727 Female    Regular          1
3     6321         660        328           721 Female Occasional          2
4     1061         864        153           615 Female         No          2
5     2863        1209         92           799 Female    Regular          1
6     1729        1439        148           654 Female         No          2</code></pre>
</div>
</div>
<p>The Quetelet index is a measure of body mass (BMI). Suppose we are interested in whether smokers and nonsmokers have the same variability of BMI scores.</p>
<p><br>
<br>
<br>
<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(Quetelet<span class="sc">~</span>Smoke,<span class="at">data=</span>NutritionStudy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  Quetelet by Smoke
F = 1.563, num df = 271, denom df = 42, p-value = 0.08157
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.9438906 2.3908039
sample estimates:
ratio of variances 
          1.563047 </code></pre>
</div>
</div>
<p>Now that we’ve covered one predictor variable with two levels, we can move on to one predictor variable with more than 2 levels.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Section 3 Sampling Distributions.html" class="pagination-link" aria-label="Sampling Distributions and Foundations of Statistical Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sampling Distributions and Foundations of Statistical Inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Section 5 One Pred More Than Two Levels.html" class="pagination-link" aria-label="One Predictor/Explanatory Variable, More Than Two Levels">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">One Predictor/Explanatory Variable, More Than Two Levels</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>